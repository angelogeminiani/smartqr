
(function(window, SF, $, undefined) { 
    
    // ------------------------------------------------------------------------
    //                      LOAD
    //                      
    //                      dependencies:
    //                          sf-base.js
    //                      uses:
    //                          sf-base_uri.js
    // ------------------------------------------------------------------------
    
    
    // ------------------------------------------------------------------------
    //                      script
    // ------------------------------------------------------------------------
    //-- script namespace --//
    SF.script = SF.script||{};
    
    /**
     * Load and execute  a script synchronously.
     * @param filename (string) Name path of file to download
     * @param options
     */
    SF.script.load = function(/* string */ filename, /* object */ options){
        var opts = {
            async: false, 
            dataType: 'script',
            timeout: 500,
            url: SF.uri.navpath(filename),
            error: function(jqXHR, textStatus, errorThrown){
                var message = errorThrown&&errorThrown.message?errorThrown.message:errorThrown?errorThrown:'';
                SF.error("Error loading: '" + filename + "'. " + message);
            }
        }
        return $.ajax(options?$.extend(opts, options):opts);
    };
    
    // ------------------------------------------------------------------------
    //                      html
    // ------------------------------------------------------------------------
    //-- html namespace --//
    SF.html = SF.html||{};
    
    /**
     * Load and execute  a HTML as plain text; 
     * included script tags are evaluated when inserted in the DOM.
     * @param {string} filename  Name path of file to download
     * @param {object} options Optional ajax options to override defaults. ex: {async: true}
     */
    SF.html.load = function(filename, options){
        if(SF.hasText(filename)){
            var opts = {
                async: false, 
                dataType: 'html',
                timeout: 500,
                url: SF.uri.navpath(filename)
            }
            return $.ajax(options?$.extend(opts, options):opts);
        } 
        return null;
    };
    
    // ------------------------------------------------------------------------
    //                      html
    // ------------------------------------------------------------------------
    //-- html namespace --//
    SF.css = SF.css||{};
    
    /**
     * Load and execute a CSS as plain text;
     * @param filename (string) Name path of file to download
     * @param options (object) Optional ajax options to override defaults. ex: {async: true}
     */
    SF.css.load = function(/* string */ filename, /* object */ options){
        var 
        opts = {
            async: false, 
            dataType: 'text',
            timeout: 500,
            url: SF.uri.navpath(filename)
        }, response;
        
        response = $.ajax(options?$.extend(opts, options):opts);
        
        $('head').append('<style>'+response.responseText+'</style>');
        
        return response;
    };
    
    // ------------------------------------------------------------------------
    //                      component
    // ------------------------------------------------------------------------
    //-- component namespace --//
    SF.component = SF.component||{};
    
    /**
     * Load HTML component synchronous and returns plain text.
     * 
     * @param filename (string) file to load
     * @param replace (object) Optional object for text format. ex. {'id':id, 'title':title}
     **/
    SF.component.load = function(filename, replace){
        var 
        response = SF.html.load(filename),
        text = response?response.responseText:"";
        
        if(replace){
            return SF.format(text, replace);
        }
        return text;
    }
    
    
    
})(window, smartforge, jQuery);
